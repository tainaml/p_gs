{% load social_tags %}
{% load thumbor_tags %}
{% load taxonomy_tags %}

<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <div class="post-info">
            <time datetime="{{ instance.publishin|date:"d/m/Y G:i" }}" itemprop="datePublished">{{ instance.publishin|date:'d/m/Y' }} às {{ instance.publishin|date:'G:i' }}</time>
            <a href="javascript:;" data-toggle="dropdown"><i class="gsticon gsticon-gear"></i></a>
            <div class="dropdown-menu">
                <ul class="perfil-actions">
                    <li><a href="javascript:;"><i class="gsticon gsticon-edit"></i> Editar publicação</a></li>
                    <li><a href="javascript:;" data-suggest-modal="true" data-content="article" data-object="{{ instance.id }}" data-url="{% url 'socialactions:act-suggest' instance.id 'article' %}"><i class="gsticon gsticon-paper-plane"></i> Sugerir</a></li>
                    <li><a href="javascript:;"><i class="gsticon gsticon-eye"></i> Ver depois</a></li>
                    <li><a href="javascript:;"><i class="gsticon gsticon-star"></i> Favoritar</a></li>
                    <li><a href="{% url 'complaint:report' 'article' instance.id %}" data-trigger="report" data-async-module="click" data-async-target="#modal-report" data-async-method="get"><i class="gsticon gsticon-exclamation-triangle"></i> Denunciar</a></li>
                </ul>
            </div>
        </div>
        <a class="post-creator" href="{% url 'profile:show' username=instance.author.username %}">
            <img src="{% thumbor_url instance.author.profile.get_profile_picture.url width=20 height=20 smart=False fit_in=False %}" alt="foto de {{ instance.author.get_full_name }}">
            {{instance.author.get_full_name}}
        </a>
    </header>
    <a class="post-content" href="{% url 'article:view' instance.slug instance.id %}" itemprop="articleBody">
        <figure>
            {% if instance.get_image %}
                <img src="{% thumbor_url instance.get_image.url width=170 height=128 smart=False fit_in=False %}" alt="{{ instance.title }}">
            {% endif %}
        </figure>
        <div class="post-text">
            <h3 class="post-title" itemprop="headline">{{ instance.title }} </h3>
            <p>{{ instance.text|safe|striptags|escape|slice:":90"}}... </p>
        </div>
    </a>
    <footer class="post-footer">
        {% taxonomies instance %}
        <div class="post-toolbar pull-right">
            <div class="post-count">
                {% like_box instance request.path "inline" %}
            </div>
            <div class="post-count-comments">
                <span id="load-count-comment-article"
                      data-load-async="true"
                      data-load-async-url="{% url 'comment:count' instance.id "article" %}"
                      data-load-async-method="get"
                      data-load-async-response-type="json">
                    <strong class="load-async load-async-content">0</strong>
                    {% csrf_token %}
                </span> Comentários
            </div>
        </div>
    </footer>
</article>