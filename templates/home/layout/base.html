{% load staticfiles %}
{% load core_tags %}
{% load user_agents %}

<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>{% block title %}Portal GSTI - Home {% endblock %}</title>
        <link rel="stylesheet" href="{% static 'stylesheets/style.css' %}">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="{% static 'images/apple-touch-icon-57x57.png' %}" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="{% static 'images/apple-touch-icon-114x114.png' %}" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="{% static 'images/apple-touch-icon-72x72.png' %}" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="{% static 'images/apple-touch-icon-144x144.png' %}" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="{% static 'images/apple-touch-icon-60x60.png' %}" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="{% static 'images/apple-touch-icon-120x120.png' %}" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="{% static 'images/apple-touch-icon-76x76.png' %}" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="{% static 'images/apple-touch-icon-152x152.png' %}" />
        <link rel="icon" type="image/png" href="{% static 'images/favicon-196x196.png' %}" sizes="196x196" />
        <link rel="icon" type="image/png" href="{% static 'images/favicon-96x96.png' %}" sizes="96x96" />
        <link rel="icon" type="image/png" href="{% static 'images/favicon-32x32.png' %}" sizes="32x32" />
        <link rel="icon" type="image/png" href="{% static 'images/favicon-16x16.png' %}" sizes="16x16" />
        <link rel="icon" type="image/png" href="{% static 'images/favicon-128.png' %}" sizes="128x128" />
        <meta name="application-name" content="&nbsp;"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="{% static 'images/mstile-144x144.png' %}" />
        <meta name="msapplication-square70x70logo" content="{% static 'images/mstile-70x70.png' %}" />
        <meta name="msapplication-square150x150logo" content="{% static 'images/mstile-150x150.png' %}" />
        <meta name="msapplication-wide310x150logo" content="{% static 'images/mstile-310x150.png' %}" />
        <meta name="msapplication-square310x310logo" content="{% static 'images/mstile-310x310.png' %}" />
    </head>
    <body>
        <header class="header">
            <div class="container">
                <div class="row">
                    <h1 class="gsti">
                        <a href="{% url 'index' %}" class="gsti-link">Portal GSTI</a>
                    </h1>
                    <div class="form-search{% if request.user.is_authenticated %}--logged{% endif %}">
                        {% include 'home/partials/search.html' %}
                    </div>
                    {% include 'home/partials/user-actions.html' %}
                </div>
            </div>
        </header>
        <section class="header-navegation">
            <div class="container">
                {% include "home/partials/mega-dropdown.html" %}
                <ul class="menu-social">
                    <li><a class="gsticon gsticon-facebook-square" href="javascript:;"></a></li>
                    <li><a class="gsticon gsticon-google-plus-square" href="javascript:;"></a></li>
                    <li><a class="gsticon gsticon-linkedin-square" href="javascript:;"></a></li>
                    <li><a class="gsticon gsticon-twitter-square" href="javascript:;"></a></li>
                    <li><a class="gsticon gsticon-youtube-square" href="javascript:;"></a></li>
                </ul>
            </div>
        </section>
        {% block content %}{% endblock %}

        {% if request|is_pc %}
            {% footer %}
        {% endif %}

        {% block modals %}

            {% include 'home/partials/modals/modal-login.html' %}
            {% include 'home/partials/modals/modal-sugerir.html' %}
            {% include 'home/partials/modals/modal-denunciar.html' %}
            {% include 'home/partials/modals/modal-rules.html' %}
            {% include 'home/partials/modals/modal-contato.html' %}
            {% include 'home/partials/modals/modal-esqueci-senha.html' %}
            {% include 'home/partials/modals/modal-alert-community-posts.html' %}
            {% include 'home/partials/modals/modal-alert-community-questions.html' %}

        {% endblock %}

        <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
        <script src="{% static 'javascripts/shared.js'%}"></script>
        <script src="{% static 'javascripts/main.js'%}"></script>

        <!-- CKEDITOR -->
        <script type="text/javascript" src="{% static "ckeditor/ckeditor/ckeditor.js" %}"></script>
        <script type="text/javascript" src="{% static "ckeditor/ckeditor-init.js" %}"></script>

        {% if request.user.is_anonymous %}
            <script src="https://www.google.com/recaptcha/api.js?hl=pt-BR" async defer></script>
        {% endif %}

        <script type="text/javascript">
            var functionAjaxSuccessLogin = function(e, data) {
                window.location.href = data.url_next;
            };

            var functionAjaxSuccessForgotPassword = function(e, data) {
                var $modalForgotPassword = $("#modal-forgot-password");
                var $modalForgotPasswordSuccessfully = $("#modal-forgot-password-successfully");
                $modalForgotPasswordSuccessfully.html(data.template);
                $modalForgotPassword.modal("hide");
                $modalForgotPasswordSuccessfully.modal("show");
            };

            var functionAjaxSuccessTriggerContactModal = function(e, data) {
                var $modalContact = $("#modal-contact");
                $modalContact.find("form[data-ajaxform=true]").IdeiaAjaxForm();
                {% if request.user.is_anonymous %}
                    grecaptcha.render('g-recaptcha', {
                        'sitekey': '6LccmgsTAAAAAGrsvn7r7aiIcnvbuIS7pyP0qv1K'
                    });
                {% endif %}
                $modalContact.modal("show");

                var functionAjaxSuccessContact = function(e, data) {
                    var $modalContact = $("#modal-contact");
                    var $modalContactSuccessfully = $("#modal-contact-successfully");
                    $modalContactSuccessfully.html(data.template);
                    $modalContact.modal("hide");
                    $modalContactSuccessfully.modal("show");
                };

                var $formContactModal = $("#form-contact-modal");
                $formContactModal.on("ajaxform.success", functionAjaxSuccessContact);
            };

            var functionAjaxSuccessTriggerReport = function(e, data) {
                var $modalReport = $("#modal-report");
                $modalReport.find("form[data-ajaxform=true]").IdeiaAjaxForm();
                $modalReport.modal("show");

                var $formReport = $("#form-report");

                $('input[type=radio][name=complaint_type]').change(function() {
                    if($('input[type=radio][name=complaint_type]:checked').val() == $formReport.data('community-complaint')) {
                        $("#communities").slideDown();
                    } else {
                        $("#communities").slideUp();
                        $(".community_complaint:checked").each(function() {
                            $(".community_complaint").prop("checked", false);
                        });
                    }
                });

                var functionAjaxReportSuccess = function(e, data) {
                    $('#modal-report').modal('hide');
                };

                $formReport.on("ajaxform.success", functionAjaxReportSuccess);
            };

            var functionAjaxSuccessSuggest = function(e, data) {
                var $self = $(this),
                    $modalSuggest = $("#modal-suggest");

                if (data.status == 200 && $modalSuggest.is(':visible')) {
                    var $taggerSuggest = $(e.currentTarget).find("#tagger-suggest-users")[0].selectize;
                    $taggerSuggest.clear();
                    $modalSuggest.modal('hide');
                }
            };

            var refreshAsyncLike = function() {
                var asyncLike = $("[data-async-like=true]");
                var asyncLikeData = asyncLike.IdeiaAsyncLike();

                var asyncClick = $("[data-async-module=click]");
                var asyncClickData = asyncClick.IdeiaAsyncClick();
            };

            var functionOpenSuggestModal = function(e) {
                e.preventDefault();
                var $self = $(this),
                    $modalSuggest = $("#modal-suggest"),
                    $formSuggest = $modalSuggest.find("form#form-suggest");

                $formSuggest.attr("action", $self.data('url'));
                $formSuggest.find("#form-suggest-object").val($self.data('object'));
                $formSuggest.find("#form-suggest-content").val($self.data('content'));
                $modalSuggest.modal("show");

                var $selectInput = $('#tagger-suggest-users');
                var $selectize = $selectInput[0].selectize;
                $selectize.focus();
            };

            $(function() {
                $(document).on("ajaxform.success", "#form-login", functionAjaxSuccessLogin);
                $(document).on("ajaxform.success", "#form-forgot-password", functionAjaxSuccessForgotPassword);
                $(document).on("ajaxform.success", "#form-suggest", functionAjaxSuccessSuggest);
                $(document).on("click", "[data-suggest-modal]", functionOpenSuggestModal);
                $(document).on("async.click.success", '[data-report="true"]', functionAjaxSuccessTriggerReport);
                $(document).on("async.click.success", "#link-contact", functionAjaxSuccessTriggerContactModal);
            });
        </script>

        {% block javascripts %}
        {% endblock %}
    </body>
</html>